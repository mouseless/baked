<!DOCTYPE html>
<html >
<head><meta charset="utf-8">
<title>Layer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta property="og:type" content="website">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Do">
<meta property="og:description" content="An opinionated framework for .NET">
<meta property="og:image" content="https://do.mouseless.codes/favicon.ico">
<meta property="og:image:width" content="50">
<meta property="og:image:height" content="50">
<link rel="icon" type="image/x-icon" href="/favicon.ico">
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
<link rel="stylesheet" type="text/css" href="https://mouseless.github.io/brand/assets/css/default.css">
<meta property="og:title" content="Layer">
<meta name="description" content="Each ILayer implementation represents an internal system component of the
software you develop. A layer provides application features with configuration
of this system component so that the features can bind domain objects and
system components together.">
<meta property="og:description" content="Each ILayer implementation represents an internal system component of the
software you develop. A layer provides application features with configuration
of this system component so that the features can bind domain objects and
system components together."><link rel="preload" as="fetch" crossorigin="anonymous" href="/architecture/layer/_payload.json"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/entry.50f5f578.js"><link rel="preload" as="style" href="/_nuxt/entry.1ca09faa.css"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/default.540cffea.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/nuxt-link.a99b69c0.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/pageStore.3996efa2.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/query.491a7473.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/utils.8151c831.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/preview.c07f3656.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/_...content-page_.e647584f.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRenderer.3ed6f1c4.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentRendererMarkdown.92e9bf85.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/index.a6ef77ff.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentDoc.77cdfd2b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ContentQuery.5527c77f.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/asyncData.910e5aa5.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH1.554c3b0d.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseP.60abea0b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCodeInline.902aba0b.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseA.916b1322.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH2.2165b1b7.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseOl.61a78b4d.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseLi.e453b562.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseCode.63a9f988.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseBlockquote.faeb295e.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH3.78b5da30.js"><link rel="modulepreload" as="script" crossorigin href="/_nuxt/ProseH4.6ccfe951.js"><link rel="prefetch" as="script" crossorigin href="/_nuxt/error-component.10f99a80.js"><link rel="stylesheet" href="/_nuxt/entry.1ca09faa.css"><style>.content[data-v-9f599d13],.full[data-v-9f599d13]{box-sizing:border-box;margin:auto;max-width:calc(var(--width-content) + 34em);min-width:270px}@media (max-width:1830px){.content[data-v-9f599d13],.full[data-v-9f599d13]{max-width:calc(var(--width-content) + 34em)}}@media (max-width:1330px){.content[data-v-9f599d13],.full[data-v-9f599d13]{max-width:calc(var(--width-content) + 19em)}}@media (max-width:1074px){.content[data-v-9f599d13],.full[data-v-9f599d13]{max-width:calc(var(--width-content))}}@media (max-width:818px){.content[data-v-9f599d13],.full[data-v-9f599d13]{max-width:82%}}.content[data-v-9f599d13]{display:grid;grid-template-areas:"side content" "side content";grid-template-columns:15em;grid-template-rows:65px 1fr}.side[data-v-9f599d13]{grid-area:side}article[data-v-9f599d13]{grid-area:content}@media (max-width:1330px){.content[data-v-9f599d13]{margin-top:0}}@media (max-width:1074px){.side[data-v-9f599d13]{grid-column-end:content;z-index:2}article[data-v-9f599d13]{grid-column-start:side}}@media (max-width:818px){.content[data-v-9f599d13]{display:block}}</style><style>div.top[data-v-d2afd16f]{border-bottom:2px solid var(--color-bg-soft)}header[data-v-d2afd16f]{align-items:center;box-sizing:border-box;display:flex;flex-direction:row;justify-content:space-between;margin:auto;max-width:calc(var(--width-content) + 34em);min-width:270px}@media (max-width:1830px){header[data-v-d2afd16f]{max-width:calc(var(--width-content) + 34em)}}@media (max-width:1330px){header[data-v-d2afd16f]{max-width:calc(var(--width-content) + 19em)}}@media (max-width:1074px){header[data-v-d2afd16f]{max-width:calc(var(--width-content))}}@media (max-width:818px){header[data-v-d2afd16f]{max-width:82%}}header .bars[data-v-d2afd16f]{display:none}div.logo[data-v-d2afd16f]{margin:20px 0}div.logo a[data-v-d2afd16f]:has(img.logo){display:block;height:25px}div.logo a:has(img.logo) img.do[data-v-d2afd16f]:is(.logo){display:inline-block;height:25px}a[data-v-d2afd16f]{color:var(--color-fg-soft);cursor:pointer}a[data-v-d2afd16f]:hover{color:var(--color-logo-mark)}nav a[data-v-d2afd16f]{margin:1em;text-decoration:none}nav a.close[data-v-d2afd16f]{display:none}nav a.active[data-v-d2afd16f]{border-bottom-color:var(--color-bg-soft);border-bottom:2px solid var(--color-logo-mark);padding-bottom:22px}nav a[data-v-d2afd16f]:last-child{margin-right:0}@media (max-width:1830px){nav a.active[data-v-d2afd16f]{padding-bottom:24px}}@media (max-width:1074px){a.bars[data-v-d2afd16f]{display:block}nav[data-v-d2afd16f]{background:var(--color-bg);border-left:2px solid var(--color-bg-soft);display:none;height:100%;padding:20px;position:fixed;right:0;top:0;width:calc(270px - 4em);z-index:99}nav a[data-v-d2afd16f],nav.active[data-v-d2afd16f]{display:block}nav a[data-v-d2afd16f]{height:2em}nav a.close[data-v-d2afd16f]{display:block;margin-bottom:1em}nav a.close i[data-v-d2afd16f]{font-size:larger}nav a.active[data-v-d2afd16f]{border:0;border-left-color:var(--color-bg-soft);border-left:2px solid var(--color-logo-mark);margin-left:-22px;padding-bottom:0;padding-left:calc(20px + 1em)}}@media (max-width:818px){nav[data-v-d2afd16f]{width:calc(270px - 7em)}}</style><style>nav[data-v-9dee0249]{align-self:start;margin-top:2.5em;position:sticky;top:1.5em}nav h4[data-v-9dee0249]{display:none}nav ul[data-v-9dee0249]{margin:0;padding:0}nav ul li[data-v-9dee0249]{list-style:none;margin:0}nav ul li a[data-v-9dee0249]{border-radius:calc(var(--border-radius)/3);color:var(--color-fg-soft);display:block;font-size:1em;padding:.5em 1em;text-decoration:none}nav ul li a[data-v-9dee0249]:hover{color:var(--color-logo-mark)}nav ul li a.active[data-v-9dee0249]{background-color:var(--color-bg-soft)}@media (max-width:1330px){nav[data-v-9dee0249]{margin-top:3.5em}}@media (max-width:1074px){nav[data-v-9dee0249]{margin-top:0;top:0;width:50%}nav h4[data-v-9dee0249]{display:block;font-size:.9em;text-transform:uppercase}nav h4 a[data-v-9dee0249]{padding-left:0}nav h4 a[data-v-9dee0249]:hover{color:var(--color-logo-mark)}nav ul[data-v-9dee0249]{background-color:var(--color-bg-box);background-color:var(--color-bg-soft);border-bottom-left-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);box-sizing:border-box;display:none;padding:calc(var(--border-radius) - .5em) calc(var(--border-radius) - 1em);position:absolute;width:200%}nav ul.active[data-v-9dee0249]{display:block}nav ul li a.active[data-v-9dee0249]{background-color:var(--color-bg-mute)}}@media (max-width:818px){nav[data-v-9dee0249]{margin-bottom:-3.7em}}</style><style>.container[data-v-b51ceff2]{display:flex}.container .content[data-v-b51ceff2]{margin:0 4em;max-width:var(--width-content);width:100%}@media (max-width:1330px){.container[data-v-b51ceff2]{flex-direction:column-reverse;margin-left:4em}.container .content[data-v-b51ceff2]{margin:1em 0 0}}@media (max-width:1074px){.container[data-v-b51ceff2]{margin-left:0}}</style><style>.full .content{margin-left:0!important;margin-right:0!important}@media (max-width:1330px){.full .container{margin-left:0}}</style><style>div.bottom[data-v-1bbc78ba]{border-top:2px solid var(--color-bg-soft);margin-top:4em}footer[data-v-1bbc78ba]{align-items:flex-start;box-sizing:border-box;display:flex;flex-direction:row;justify-content:space-between;margin:1em auto;max-width:calc(var(--width-content) + 34em);min-width:270px}@media (max-width:1830px){footer[data-v-1bbc78ba]{max-width:calc(var(--width-content) + 34em)}}@media (max-width:1330px){footer[data-v-1bbc78ba]{max-width:calc(var(--width-content) + 19em)}}@media (max-width:1074px){footer[data-v-1bbc78ba]{max-width:calc(var(--width-content))}}@media (max-width:818px){footer[data-v-1bbc78ba]{max-width:82%}}footer[data-v-1bbc78ba],footer *[data-v-1bbc78ba]{color:var(--color-fg-mute)}footer div[data-v-1bbc78ba],footer nav[data-v-1bbc78ba]{font-family:var(--font-heading);font-size:smaller}div.logo[data-v-1bbc78ba]{margin:20px 0}div.logo a[data-v-1bbc78ba]:has(img.logo){display:block;height:15px}div.logo a:has(img.logo) img.do[data-v-1bbc78ba]:is(.logo){display:inline-block;height:15px;opacity:.5}div.logo span[data-v-1bbc78ba]{display:inline-block;margin-top:1em}nav[data-v-1bbc78ba]{text-align:right}nav a[data-v-1bbc78ba]{display:block;margin:5px;text-decoration:none}nav a[data-v-1bbc78ba]:hover,nav a:hover i[data-v-1bbc78ba]{color:var(--color-logo-mark)}@media (max-width:818px){footer[data-v-1bbc78ba]{display:block}footer nav[data-v-1bbc78ba]{text-align:left}footer nav a[data-v-1bbc78ba]{margin-left:0}}</style><style>.navigation-buttons-container[data-v-6a000fc9]{margin-top:4em;max-width:var(--width-content)}.navigation-buttons-container .button[data-v-6a000fc9]{margin-top:.9em;padding-left:.4em;padding-right:.4em}.navigation-buttons-container .button a[data-v-6a000fc9]{text-decoration:none}.navigation-buttons-container .button a .link-text[data-v-6a000fc9]{color:var(--color-fg-mute);font-size:.75em}.navigation-buttons-container .button a .link-text h3[data-v-6a000fc9]{color:var(--color-fg-soft);font-size:1.5em;margin-top:.1em}.navigation-buttons-container .button a:hover h3[data-v-6a000fc9]{color:var(--color-logo-mark)}.navigation-buttons-container .button.left[data-v-6a000fc9]{float:left;text-align:left}.navigation-buttons-container .button.right[data-v-6a000fc9]{float:right;text-align:end}</style><style>h4[data-v-4f8affad]{margin-bottom:.5em;padding-left:1em}h4[data-v-4f8affad],nav[data-v-4f8affad]{font-size:.9em}nav[data-v-4f8affad]{text-wrap:nowrap;align-self:start;margin-top:2.5em;overflow:hidden;position:sticky;top:1.5em;width:15em}nav ul[data-v-4f8affad]{margin:0;padding-left:0}nav ul li[data-v-4f8affad]{line-height:24px;list-style:none;margin:0}nav ul li a[data-v-4f8affad]{border-left:2px solid transparent;color:var(--color-fg-soft);cursor:pointer;display:block;font-size:.9em;margin-top:.25em;overflow:hidden;padding-left:1em;text-decoration:none;text-overflow:ellipsis}nav ul li a[data-v-4f8affad]:hover{color:var(--color-logo-mark)}nav ul li a.active[data-v-4f8affad]{border-left-color:var(--color-bg-mute)}nav ul li a.return-to-top[data-v-4f8affad]{margin-top:.75em}nav ul li ul[data-v-4f8affad]{margin-bottom:.25em}nav ul li ul a[data-v-4f8affad]{padding-left:2em}@media (max-width:1330px){nav[data-v-4f8affad]{background-color:var(--color-bg);font-size:1em;margin:0 0 -3.7em;text-align:right;top:0;width:100%}nav h4 a[data-v-4f8affad]{display:inline-block;padding-left:0;padding-right:0}nav h4 a[data-v-4f8affad]:hover{color:var(--color-logo-mark)}nav>ul[data-v-4f8affad]{background-color:var(--color-bg-box);background-color:var(--color-bg-soft);border-bottom-left-radius:var(--border-radius);border-bottom-right-radius:var(--border-radius);border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);display:none;margin-bottom:2.5em;padding:var(--border-radius);padding-left:0;text-align:left}nav>ul.active[data-v-4f8affad]{display:block}nav ul li a[data-v-4f8affad]{padding-left:var(--border-radius)}nav ul li a.active[data-v-4f8affad]:before{left:0}nav ul li ul li a[data-v-4f8affad]{padding-left:calc(var(--border-radius) + 1em)}}</style><style>a[data-v-f8417185]{font-family:var(--font-default)}i[data-v-f8417185]{margin-left:.3em}</style><style>pre code .line{display:block;min-height:1rem}</style><style>blockquote[data-v-cab260a3]{align-items:flex-start;border-radius:10px;display:flex;flex-direction:row;justify-content:flex-start;margin:1em 0;max-width:var(--width-content);padding:0}blockquote i[data-v-cab260a3]{line-height:var(--line-height);margin-top:1em;position:absolute}blockquote div[data-v-cab260a3]{padding-left:3ch;width:100%}blockquote.info i[data-v-cab260a3]{color:var(--color-blue)}blockquote.warning i[data-v-cab260a3]{color:var(--color-orange)}blockquote.tip i[data-v-cab260a3]{color:var(--color-green)}blockquote.danger i[data-v-cab260a3]{color:var(--color-red)}blockquote.default i[data-v-cab260a3]{color:var(--color-fg)}@media (min-width:1830px){blockquote i[data-v-cab260a3]{line-height:calc(var(--line-height)*1.1)}}</style></head>
<body ><div id="__nuxt"><div data-v-9f599d13><div class="top" data-v-9f599d13 data-v-d2afd16f><header data-v-d2afd16f><div class="logo" data-v-d2afd16f><a href="/" class="" data-v-d2afd16f><img class="do logo" data-v-d2afd16f></a></div><a class="bars" data-v-d2afd16f><i class="fa-solid fa-bars" data-v-d2afd16f></i></a><nav class="" data-v-d2afd16f><a class="close" data-v-d2afd16f><i class="fa-solid fa-close" data-v-d2afd16f></i></a><!--[--><a href="/blueprints" class="" data-v-d2afd16f>Blueprints</a><a href="/features" class="" data-v-d2afd16f>Features</a><a href="/layers" class="" data-v-d2afd16f>Layers</a><a href="/architecture" class="active" data-v-d2afd16f>Architecture</a><a href="/release-notes" class="" data-v-d2afd16f>Release Notes</a><!--]--><a href="https://github.com/mouseless/do" rel="noopener noreferrer" target="_blank" data-v-d2afd16f><i class="fa-brands fa-github" data-v-d2afd16f></i></a></nav></header></div><div class="content" data-v-9f599d13><nav class="side" data-v-9f599d13 data-v-9dee0249><h4 data-v-9dee0249><a data-v-9dee0249>Pages</a></h4><ul class="" data-v-9dee0249><li data-v-9dee0249><!--[--><!--]--></li></ul></nav><article data-v-9f599d13><!--[--><!--[--><div class="container" data-v-b51ceff2><div class="content" data-v-b51ceff2><div class="toc-root" data-v-b51ceff2><h1 id="layer"><!--[-->Layer<!--]--></h1><p><!--[-->Each <code><!--[-->ILayer<!--]--></code> implementation represents an internal system component of the
software you develop. A layer provides application features with configuration
of this system component so that the features can bind domain objects and
system components together.<!--]--></p><p><!--[-->Let&#39;s take relational database as an example. A relational database is treated
as an internal system component and is introduced by the <code><!--[-->DataAccessLayer<!--]--></code> along
with a configuration API. This API enables a feature to map your domain entities
to database tables.<!--]--></p><p><!--[-->Another good example is the <code><!--[-->HttpServerLayer<!--]--></code>. This layer introduces the ASP.NET
Core framework into your application. It provides three phases, as mentioned in
<a href="/architecture/application" class="" data-v-f8417185><!--[-->Application<!--]--><!----></a>, along with <code><!--[-->IMiddlewareCollection<!--]--></code> and
<code><!--[-->IEndpointRouteBuilder<!--]--></code> objects as its configuration API. This way, any feature
has the ability to use a middleware or add routes to the application.<!--]--></p><h2 id="conventions"><!--[-->Conventions<!--]--></h2><p><!--[-->For a consistent developer experience, follow below conventions when
implementing a new layer;<!--]--></p><ol><!--[--><li><!--[-->Place all layer related classes under the same folder named after layer,
e.g., <code><!--[-->DependencyInjection/<!--]--></code><!--]--></li><li><!--[-->Use <code><!--[-->Layer<!--]--></code> suffix in layer class name, e.g.,
<code><!--[-->DependencyInjection/DependencyInjectionLayer.cs<!--]--></code><!--]--></li><li><!--[-->Provide extension methods in <code><!--[-->Do<!--]--></code> namespace, e.g.,
<code><!--[-->DependencyInjection/DependencyInjectionExtensions.cs<!--]--></code>;<ol><!--[--><li><!--[--><code><!--[-->Add<!--]--></code> extension to <code><!--[-->List&lt;ILayer&gt;<!--]--></code>, e.g., <code><!--[-->AddDependencyInjection()<!--]--></code><!--]--></li><li><!--[--><code><!--[-->Get<!--]--></code> extensions to <code><!--[-->ApplicationContext<!--]--></code>, e.g.,
<code><!--[-->GetWebApplicationBuilder()<!--]--></code>, <code><!--[-->GetWebApplication()<!--]--></code><!--]--></li><li><!--[--><code><!--[-->Configure<!--]--></code> extensions to <code><!--[-->LayerConfigurator<!--]--></code> per configuration
target(s), e.g., <code><!--[-->ConfigureServiceCollection()<!--]--></code><!--]--></li><!--]--></ol><!--]--></li><li><!--[-->Place phase implementations as nested classes under the layer class<!--]--></li><li><!--[-->Don&#39;t use any suffix for phases and use method-like names, e.g., <code><!--[-->Build<!--]--></code> and
<code><!--[-->Run<!--]--></code><!--]--></li><!--]--></ol><p><!--[-->Please refer to existing layers in <a href="https://github.com/mouseless/do" rel="nofollow" target="_blank" data-v-f8417185><!--[-->github.com/mouseless/do<!--]--><i class="fa-solid fa-arrow-up-right-from-square" data-v-f8417185></i></a> for examples.<!--]--></p><h2 id="creating-a-layer"><!--[-->Creating A Layer<!--]--></h2><p><!--[-->To create a layer, create a class using above conventions and extend
<code><!--[-->LayerBase<!--]--></code>.<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerX</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    ...
</span></span><span class="line" line="4"><span class="ct-95e08c">}</span></span></code></pre><!--]--><blockquote class="tip" data-v-cab260a3><i class="fa fa-lightbulb" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[-->You can directly implement provided interface <code><!--[-->ILayer<!--]--></code>, however we&#39;ve created
some base classes to make it easier for you to create layers. All examples
demonstrate usage of these base classes.<!--]--></p><!--]--></div></blockquote><h3 id="id-of-a-layer"><!--[--><code><!--[-->Id<!--]--></code> of a Layer<!--]--></h3><p><!--[--><code><!--[-->ILayer<!--]--></code> has an <code><!--[-->Id<!--]--></code> property which should be a unique per <code><!--[-->Application<!--]--></code>
instance. <code><!--[-->LayerBase<!--]--></code> sets the <code><!--[-->Id<!--]--></code> as name of the concrete class e.g.,
<code><!--[-->LayerX<!--]--></code> at above example.<!--]--></p><p><!--[-->You can override its value in layer implementation class as shown below;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerX</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-2137a1">string</span><span class="ct-95e08c"> </span><span class="ct-3c061d">Id</span><span class="ct-95e08c"> </span><span class="ct-19930a">=&gt;</span><span class="ct-95e08c"> </span><span class="ct-c51e03">&quot;CustomUniqueId&quot;
</span></span><span class="line" line="4"><span class="ct-95e08c">    ...
</span></span><span class="line" line="5"><span class="ct-95e08c">}</span></span></code></pre><!--]--><h2 id="adding-phases"><!--[-->Adding Phases<!--]--></h2><p><!--[-->By default <code><!--[-->LayerBase<!--]--></code> returns no phases. To add one or more phases into the
application, you need to override <code><!--[-->GetPhases()<!--]--></code> method as shown below;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">SampleLayer</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-19c693">IEnumerable</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">IPhase</span><span class="ct-95e08c">&gt; </span><span class="ct-935844">GetPhases</span><span class="ct-95e08c">()
</span></span><span class="line" line="4"><span class="ct-95e08c">    {
</span></span><span class="line" line="5"><span class="ct-95e08c">        </span><span class="ct-bae057">yield</span><span class="ct-95e08c"> </span><span class="ct-bae057">return</span><span class="ct-95e08c"> </span><span class="ct-2137a1">new</span><span class="ct-95e08c"> </span><span class="ct-19c693">DoA</span><span class="ct-95e08c">();
</span></span><span class="line" line="6"><span class="ct-95e08c">        </span><span class="ct-bae057">yield</span><span class="ct-95e08c"> </span><span class="ct-bae057">return</span><span class="ct-95e08c"> </span><span class="ct-2137a1">new</span><span class="ct-95e08c"> </span><span class="ct-19c693">DoB</span><span class="ct-95e08c">();
</span></span><span class="line" line="7"><span class="ct-95e08c">    }
</span></span><span class="line" line="8"><span>
</span></span><span class="line" line="9"><span class="ct-95e08c">    </span><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">DoA</span><span class="ct-95e08c"> : </span><span class="ct-19c693">PhaseBase</span><span class="ct-95e08c"> { ... }
</span></span><span class="line" line="10"><span class="ct-95e08c">    </span><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">DoB</span><span class="ct-95e08c"> : </span><span class="ct-19c693">PhaseBase</span><span class="ct-95e08c"> { ... }
</span></span><span class="line" line="11"><span class="ct-95e08c">}</span></span></code></pre><!--]--><p><!--[-->Here <code><!--[-->SampleLayer<!--]--></code> adds two phases, <code><!--[-->DoA<!--]--></code> and <code><!--[-->DoB<!--]--></code>, to the application.<!--]--></p><blockquote class="tip" data-v-cab260a3><i class="fa fa-lightbulb" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[-->By convention place the phase implementations as a nested class in the layer
it is added.<!--]--></p><!--]--></div></blockquote><h3 id="initializing-a-phase"><!--[-->Initializing a Phase<!--]--></h3><p><!--[--><code><!--[-->PhaseBase<!--]--></code> class has <code><!--[-->Initialize()<!--]--></code> method to override so that it can add an
object to the application context via <code><!--[-->Context<!--]--></code> property. Below, you can see
how <code><!--[-->CreateBuilder<!--]--></code> phase adds <code><!--[-->WebApplicationBuilder<!--]--></code> to the context;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">CreateBuilder</span><span class="ct-95e08c"> : </span><span class="ct-19c693">PhaseBase
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-2137a1">void</span><span class="ct-95e08c"> </span><span class="ct-935844">Initialize</span><span class="ct-95e08c">()
</span></span><span class="line" line="4"><span class="ct-95e08c">    {
</span></span><span class="line" line="5"><span class="ct-95e08c">        </span><span class="ct-2137a1">var</span><span class="ct-95e08c"> </span><span class="ct-3c061d">build</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-3c061d">WebApplication</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateBuilder</span><span class="ct-95e08c">();
</span></span><span class="line" line="6"><span>
</span></span><span class="line" line="7"><span class="ct-95e08c">        </span><span class="ct-3c061d">Context</span><span class="ct-95e08c">.</span><span class="ct-935844">Add</span><span class="ct-95e08c">(</span><span class="ct-3c061d">build</span><span class="ct-95e08c">);
</span></span><span class="line" line="8"><span class="ct-95e08c">    }
</span></span><span class="line" line="9"><span class="ct-95e08c">}</span></span></code></pre><!--]--><blockquote class="tip" data-v-cab260a3><i class="fa fa-lightbulb" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[-->You can directly implement provided interface <code><!--[-->IPhase<!--]--></code>, however we&#39;ve created
some base classes to make it easier for you to create phases. All examples
demonstrate usage of these base classes.<!--]--></p><!--]--></div></blockquote><h3 id="readiness-via-dependencies"><!--[-->Readiness via Dependencies<!--]--></h3><p><!--[-->You can define context dependencies via generic <code><!--[-->PhaseBase&lt;&gt;<!--]--></code> classes to make
the phase wait until context is ready to provide that dependency. For example,
<code><!--[-->Build<!--]--></code> depends on the <code><!--[-->WebApplicationBuilder<!--]--></code> instance as shown below;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">Build</span><span class="ct-95e08c"> : </span><span class="ct-19c693">PhaseBase</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">WebApplicationBuilder</span><span class="ct-95e08c">&gt;
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-2137a1">void</span><span class="ct-95e08c"> </span><span class="ct-935844">Initialize</span><span class="ct-95e08c">(</span><span class="ct-19c693">WebApplicationBuilder</span><span class="ct-95e08c"> </span><span class="ct-3c061d">build</span><span class="ct-95e08c">)
</span></span><span class="line" line="4"><span class="ct-95e08c">    {
</span></span><span class="line" line="5"><span class="ct-95e08c">        </span><span class="ct-2137a1">var</span><span class="ct-95e08c"> </span><span class="ct-3c061d">app</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-3c061d">build</span><span class="ct-95e08c">.</span><span class="ct-935844">Build</span><span class="ct-95e08c">();
</span></span><span class="line" line="6"><span>
</span></span><span class="line" line="7"><span class="ct-95e08c">        </span><span class="ct-3c061d">Context</span><span class="ct-95e08c">.</span><span class="ct-935844">Add</span><span class="ct-95e08c">(</span><span class="ct-3c061d">app</span><span class="ct-95e08c">);
</span></span><span class="line" line="8"><span class="ct-95e08c">    }
</span></span><span class="line" line="9"><span class="ct-95e08c">}</span></span></code></pre><!--]--><p><!--[--><code><!--[-->PhaseBase&lt;T&gt;<!--]--></code> class requires <code><!--[-->Initialize(T t)<!--]--></code> method to be implemented.<!--]--></p><blockquote class="info" data-v-cab260a3><i class="fa fa-circle-info" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[-->You can provide more than one dependency for a phase. E.g., <code><!--[-->Phase&lt;X, Y&gt;<!--]--></code>
will require <code><!--[-->Initialize(X x, Y y)<!--]--></code> method to be implemented.<!--]--></p><!--]--></div></blockquote><blockquote class="warning" data-v-cab260a3><i class="fa fa-warning" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[-->Type of the dependency provided, must be exactly the same as the type of
dependency in <code><!--[-->ApplicationContext<!--]--></code>. For more information
<a href="/architecture/application#running-an-application" class="" data-v-f8417185><!--[-->Running an Application<!--]--><!----></a><!--]--></p><!--]--></div></blockquote><h3 id="order-of-a-phase"><!--[-->Order of a Phase<!--]--></h3><p><!--[--><code><!--[-->PhaseBase<!--]--></code> classes has <code><!--[-->order<!--]--></code> parameter in their constructors. Default order
is <code><!--[-->PhaseOrder.Normal<!--]--></code>. If you need to change the order, pass the desired order
to this parameter as shown below;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">DoThisEarlyOn</span><span class="ct-95e08c"> : </span><span class="ct-19c693">PhaseBase
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-935844">DoThisEarlyOn</span><span class="ct-95e08c">() : </span><span class="ct-2137a1">base</span><span class="ct-95e08c">(</span><span class="ct-3c061d">PhaseOrder</span><span class="ct-95e08c">.</span><span class="ct-3c061d">Early</span><span class="ct-95e08c">) { }
</span></span><span class="line" line="4"><span class="ct-95e08c">}</span></span></code></pre><!--]--><h2 id="providing-configuration"><!--[-->Providing Configuration<!--]--></h2><p><!--[-->Layers provide configuration objects phase by phase. This means a layer can
provide two different configuration objects for two different phases. For this
reason, a layer returns <code><!--[-->PhaseContext<!--]--></code> instance per phase to which it provides
configuration.<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerX</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c">&gt;
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerXConfiguration</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="4"><span>
</span></span><span class="line" line="5"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-19c693">PhaseContext</span><span class="ct-95e08c"> </span><span class="ct-935844">GetContext</span><span class="ct-95e08c">(</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="6"><span class="ct-95e08c">        </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateContext</span><span class="ct-95e08c">(</span><span class="ct-3c061d">_configuration</span><span class="ct-95e08c">);
</span></span><span class="line" line="7"><span class="ct-95e08c">}</span></span></code></pre><!--]--><p><!--[-->In this example, you see a layer named <code><!--[-->LayerX<!--]--></code> providing a
<code><!--[-->LayerXConfiguration<!--]--></code> instance during <code><!--[-->AddServices<!--]--></code> phase.<!--]--></p><blockquote class="info" data-v-cab260a3><i class="fa fa-circle-info" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[-->By default, a layer returns <code><!--[-->PhaseContext.Empty<!--]--></code> instance for the phases it
does not provide a configuration. This means <code><!--[-->Application<!--]--></code> skips that layer
for the phases it doesn&#39;t have anything to configure.<!--]--></p><!--]--></div></blockquote><h3 id="using-non-generic-layerbase"><!--[-->Using non-generic <code><!--[-->LayerBase<!--]--></code><!--]--></h3><p><!--[--><code><!--[-->LayerBase&lt;&gt;<!--]--></code> classes allow up to three generic arguments. If you need to
implement a layer that has things to configure during more than three phases,
use non-generic <code><!--[-->LayerBase<!--]--></code> class, override <code><!--[-->GetContext(IPhase phase)<!--]--></code> method
and switch given phase according to its type;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">MyLayer</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-19c693">PhaseContext</span><span class="ct-95e08c"> </span><span class="ct-935844">GetContext</span><span class="ct-95e08c">(</span><span class="ct-19c693">IPhase</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="4"><span class="ct-95e08c">        </span><span class="ct-3c061d">phase</span><span class="ct-95e08c"> </span><span class="ct-bae057">switch
</span></span><span class="line" line="5"><span class="ct-95e08c">        {
</span></span><span class="line" line="6"><span class="ct-95e08c">            PhaseA </span><span class="ct-19930a">=&gt;</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateContext</span><span class="ct-95e08c">(...),
</span></span><span class="line" line="7"><span class="ct-95e08c">            PhaseB </span><span class="ct-19930a">=&gt;</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateContext</span><span class="ct-95e08c">(...),
</span></span><span class="line" line="8"><span class="ct-95e08c">            _ </span><span class="ct-19930a">=&gt;</span><span class="ct-95e08c"> </span><span class="ct-2137a1">base</span><span class="ct-95e08c">.</span><span class="ct-935844">GetContext</span><span class="ct-95e08c">(</span><span class="ct-3c061d">phase</span><span class="ct-95e08c">)
</span></span><span class="line" line="9"><span class="ct-95e08c">        };
</span></span><span class="line" line="10"><span class="ct-95e08c">}</span></span></code></pre><!--]--><h3 id="before-and-after-a-phase"><!--[-->Before and After a Phase<!--]--></h3><p><!--[-->Layers might need to do some standard stuff before and after a phase is applied
to all features for all layers. Use <code><!--[-->GetContext()<!--]--></code> method to do stuff before,
and <code><!--[-->onDispose:<!--]--></code> delegate to do stuff after.<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerX</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c">&gt;
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerXConfiguration</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="4"><span>
</span></span><span class="line" line="5"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-19c693">PhaseContext</span><span class="ct-95e08c"> </span><span class="ct-935844">GetContext</span><span class="ct-95e08c">(</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">)
</span></span><span class="line" line="6"><span class="ct-95e08c">    {
</span></span><span class="line" line="7"><span class="ct-95e08c">        </span><span class="ct-2137a1">var</span><span class="ct-95e08c"> </span><span class="ct-3c061d">services</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-3c061d">Context</span><span class="ct-95e08c">.</span><span class="ct-935844">Get</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">IServiceCollection</span><span class="ct-95e08c">&gt;();
</span></span><span class="line" line="8"><span>
</span></span><span class="line" line="9"><span class="ct-95e08c">        </span><span class="ct-3c061d">services</span><span class="ct-95e08c">.</span><span class="ct-935844">AddStandardStuffBefore</span><span class="ct-95e08c">();
</span></span><span class="line" line="10"><span>
</span></span><span class="line" line="11"><span class="ct-95e08c">        </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateContext</span><span class="ct-95e08c">(</span><span class="ct-3c061d">_configuration</span><span class="ct-95e08c">,
</span></span><span class="line" line="12"><span class="ct-95e08c">            </span><span class="ct-3c061d">onDispose</span><span class="ct-95e08c">: () </span><span class="ct-19930a">=&gt;</span><span class="ct-95e08c"> </span><span class="ct-3c061d">services</span><span class="ct-95e08c">.</span><span class="ct-935844">AddStandardStuffAfter</span><span class="ct-95e08c">()
</span></span><span class="line" line="13"><span class="ct-95e08c">        );
</span></span><span class="line" line="14"><span class="ct-95e08c">    }
</span></span><span class="line" line="15"><span class="ct-95e08c">}</span></span></code></pre><!--]--><blockquote class="info" data-v-cab260a3><i class="fa fa-circle-info" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[-->Notice that a layer has access to the <code><!--[-->ApplicationContext<!--]--></code> instance through
<code><!--[-->Context<!--]--></code> property provided in <code><!--[-->LayerBase<!--]--></code> base class.<!--]--></p><!--]--></div></blockquote><blockquote class="warning" data-v-cab260a3><i class="fa fa-warning" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[--><code><!--[-->GetContext()<!--]--></code> method is called for every layer before applying any of them
to features. And <code><!--[-->onDispose:<!--]--></code> actions are called after applying these
contexts to all features.<!--]--></p><!--]--></div></blockquote><h3 id="providing-multiple-targets"><!--[-->Providing Multiple Targets<!--]--></h3><p><!--[-->It is possible to provide up to three configuration objects for the same phase.
There are two ways of providing multiple targets; at once or one by one.<!--]--></p><h4 id="at-once"><!--[-->At Once<!--]--></h4><p><!--[-->Below code demonstrates providing two configuration objects at once;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerX</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c">&gt;
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">Configuration1</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration1</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="4"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">Configuration2</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration2</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="5"><span>
</span></span><span class="line" line="6"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-19c693">PhaseContext</span><span class="ct-95e08c"> </span><span class="ct-935844">GetContext</span><span class="ct-95e08c">(</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="7"><span class="ct-95e08c">        </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateContext</span><span class="ct-95e08c">(</span><span class="ct-3c061d">_configuration1</span><span class="ct-95e08c">, </span><span class="ct-3c061d">_configuration2</span><span class="ct-95e08c">);
</span></span><span class="line" line="8"><span class="ct-95e08c">}</span></span></code></pre><!--]--><p><!--[-->This phase context will require an action with two parameter in a feature;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-95e08c">...
</span></span><span class="line" line="2"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">void</span><span class="ct-95e08c"> </span><span class="ct-935844">Configure</span><span class="ct-95e08c">(</span><span class="ct-19c693">LayerConfigurator</span><span class="ct-95e08c"> </span><span class="ct-3c061d">configurator</span><span class="ct-95e08c">)
</span></span><span class="line" line="3"><span class="ct-95e08c">{
</span></span><span class="line" line="4"><span class="ct-95e08c">    </span><span class="ct-3c061d">configurator</span><span class="ct-95e08c">.</span><span class="ct-935844">Configure</span><span class="ct-95e08c">((</span><span class="ct-19c693">Configuration1</span><span class="ct-95e08c"> </span><span class="ct-3c061d">configuration1</span><span class="ct-95e08c">, </span><span class="ct-19c693">Configuration2</span><span class="ct-95e08c"> </span><span class="ct-3c061d">configuration2</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="5"><span class="ct-95e08c">    {
</span></span><span class="line" line="6"><span class="ct-95e08c">        </span><span class="ct-6d4278">// use both objects to configure
</span></span><span class="line" line="7"><span class="ct-95e08c">    });
</span></span><span class="line" line="8"><span class="ct-95e08c">}
</span></span><span class="line" line="9"><span class="ct-95e08c">...</span></span></code></pre><!--]--><p><!--[-->See <a href="/architecture/feature" class="" data-v-f8417185><!--[-->Feature<!--]--><!----></a> for more information on using layer configurators
for features.<!--]--></p><h4 id="one-by-one"><!--[-->One by One<!--]--></h4><p><!--[-->Below code demonstrates providing configuration objects one by one;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerX</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c">&gt;
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">Configuration1</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration1</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="4"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">Configuration2</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration2</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="5"><span>
</span></span><span class="line" line="6"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-19c693">PhaseContext</span><span class="ct-95e08c"> </span><span class="ct-935844">GetContext</span><span class="ct-95e08c">(</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="7"><span class="ct-95e08c">        </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateContextBuilder</span><span class="ct-95e08c">()
</span></span><span class="line" line="8"><span class="ct-95e08c">            .</span><span class="ct-935844">Add</span><span class="ct-95e08c">(</span><span class="ct-3c061d">_configuration1</span><span class="ct-95e08c">)
</span></span><span class="line" line="9"><span class="ct-95e08c">            .</span><span class="ct-935844">Add</span><span class="ct-95e08c">(</span><span class="ct-3c061d">_configuration2</span><span class="ct-95e08c">)
</span></span><span class="line" line="10"><span class="ct-95e08c">            .</span><span class="ct-935844">Build</span><span class="ct-95e08c">()
</span></span><span class="line" line="11"><span class="ct-95e08c">        ;
</span></span><span class="line" line="12"><span class="ct-95e08c">}</span></span></code></pre><!--]--><p><!--[-->This phase context will require two different actions in a feature;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-95e08c">...
</span></span><span class="line" line="2"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">void</span><span class="ct-95e08c"> </span><span class="ct-935844">Configure</span><span class="ct-95e08c">(</span><span class="ct-19c693">LayerConfigurator</span><span class="ct-95e08c"> </span><span class="ct-3c061d">configurator</span><span class="ct-95e08c">)
</span></span><span class="line" line="3"><span class="ct-95e08c">{
</span></span><span class="line" line="4"><span class="ct-95e08c">    </span><span class="ct-3c061d">configurator</span><span class="ct-95e08c">.</span><span class="ct-935844">Configure</span><span class="ct-95e08c">((</span><span class="ct-19c693">Configuration1</span><span class="ct-95e08c"> </span><span class="ct-3c061d">configuration1</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="5"><span class="ct-95e08c">    {
</span></span><span class="line" line="6"><span class="ct-95e08c">        </span><span class="ct-6d4278">// configure one by one
</span></span><span class="line" line="7"><span class="ct-95e08c">    });
</span></span><span class="line" line="8"><span>
</span></span><span class="line" line="9"><span class="ct-95e08c">    </span><span class="ct-3c061d">configurator</span><span class="ct-95e08c">.</span><span class="ct-935844">Configure</span><span class="ct-95e08c">((</span><span class="ct-19c693">Configuration2</span><span class="ct-95e08c"> </span><span class="ct-3c061d">configuration2</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="10"><span class="ct-95e08c">    {
</span></span><span class="line" line="11"><span class="ct-95e08c">        </span><span class="ct-6d4278">// configure one by one
</span></span><span class="line" line="12"><span class="ct-95e08c">    });
</span></span><span class="line" line="13"><span class="ct-95e08c">}
</span></span><span class="line" line="14"><span class="ct-95e08c">...</span></span></code></pre><!--]--><blockquote class="tip" data-v-cab260a3><i class="fa fa-lightbulb" data-v-cab260a3></i><div data-v-cab260a3><!--[--><p><!--[--><code><!--[-->phase.CreateContext()<!--]--></code> is a helper method that utilizes
<code><!--[-->phase.CreateContextBuilder()<!--]--></code> behind the scenes.<!--]--></p><!--]--></div></blockquote><h4 id="using-in-combination"><!--[-->Using in Combination<!--]--></h4><p><!--[-->You may combine these two ways to provide configuration;<!--]--></p><!--[--><pre><code><span class="line" line="1"><span class="ct-2137a1">public</span><span class="ct-95e08c"> </span><span class="ct-2137a1">class</span><span class="ct-95e08c"> </span><span class="ct-19c693">LayerX</span><span class="ct-95e08c"> : </span><span class="ct-19c693">LayerBase</span><span class="ct-95e08c">&lt;</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c">&gt;
</span></span><span class="line" line="2"><span class="ct-95e08c">{
</span></span><span class="line" line="3"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">Configuration1</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration1</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="4"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">Configuration2</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration2</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="5"><span class="ct-95e08c">    </span><span class="ct-2137a1">readonly</span><span class="ct-95e08c"> </span><span class="ct-19c693">Configuration3</span><span class="ct-95e08c"> </span><span class="ct-3c061d">_configuration3</span><span class="ct-95e08c"> </span><span class="ct-19930a">=</span><span class="ct-95e08c"> </span><span class="ct-935844">new</span><span class="ct-95e08c">();
</span></span><span class="line" line="6"><span>
</span></span><span class="line" line="7"><span class="ct-95e08c">    </span><span class="ct-2137a1">protected</span><span class="ct-95e08c"> </span><span class="ct-2137a1">override</span><span class="ct-95e08c"> </span><span class="ct-19c693">PhaseContext</span><span class="ct-95e08c"> </span><span class="ct-935844">GetContext</span><span class="ct-95e08c">(</span><span class="ct-19c693">AddServices</span><span class="ct-95e08c"> </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">) </span><span class="ct-19930a">=&gt;
</span></span><span class="line" line="8"><span class="ct-95e08c">        </span><span class="ct-3c061d">phase</span><span class="ct-95e08c">.</span><span class="ct-935844">CreateContextBuilder</span><span class="ct-95e08c">()
</span></span><span class="line" line="9"><span class="ct-95e08c">            .</span><span class="ct-935844">Add</span><span class="ct-95e08c">(</span><span class="ct-3c061d">_configuration1</span><span class="ct-95e08c">, </span><span class="ct-3c061d">_configuration2</span><span class="ct-95e08c">)
</span></span><span class="line" line="10"><span class="ct-95e08c">            .</span><span class="ct-935844">Add</span><span class="ct-95e08c">(</span><span class="ct-3c061d">_configuration3</span><span class="ct-95e08c">)
</span></span><span class="line" line="11"><span class="ct-95e08c">            .</span><span class="ct-935844">Build</span><span class="ct-95e08c">()
</span></span><span class="line" line="12"><span class="ct-95e08c">        ;
</span></span><span class="line" line="13"><span class="ct-95e08c">}</span></span></code></pre><!--]--><p><!--[-->This phase context will require two different actions;<!--]--></p><ol><!--[--><li><!--[-->For the first two configuration objects: <code><!--[-->(Configuration1 configuration1, Configuration2 configuration2)<!--]--></code><!--]--></li><li><!--[-->For the last configuration object: <code><!--[-->(Configuration3 configuration3)<!--]--></code>.<!--]--></li><!--]--></ol><style>.ct-6d4278{color:#6A9955}
.ct-bae057{color:#C586C0}
.ct-935844{color:#DCDCAA}
.ct-c51e03{color:#CE9178}
.ct-19930a{color:#D4D4D4}
.ct-3c061d{color:#9CDCFE}
.ct-19c693{color:#4EC9B0}
.ct-95e08c{color:#E6E6E6}
.ct-2137a1{color:#569CD6}</style></div><div class="navigation-buttons-container" data-v-b51ceff2 data-v-6a000fc9><div class="button left" data-v-6a000fc9><a href="/architecture/application" class="" data-v-6a000fc9><div class="link-text" data-v-6a000fc9><i class="fa-solid fa-caret-left" data-v-6a000fc9></i> Previous <h3 data-v-6a000fc9>Application</h3></div></a></div><div class="button right" data-v-6a000fc9><a href="/architecture/feature" class="" data-v-6a000fc9><div class="link-text" data-v-6a000fc9> Next <i class="fa-solid fa-caret-right" data-v-6a000fc9></i><h3 data-v-6a000fc9>Feature</h3></div></a></div></div></div><nav data-v-b51ceff2 data-v-4f8affad><h4 data-v-4f8affad><a data-v-4f8affad>On This Page</a></h4><ul class="" data-v-4f8affad><!--[--><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#conventions" class="router-link-active router-link-exact-active" data-v-4f8affad>Conventions</a><ul data-v-4f8affad><!--[--><!--]--></ul></li><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#creating-a-layer" class="router-link-active router-link-exact-active" data-v-4f8affad>Creating A Layer</a><ul data-v-4f8affad><!--[--><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#id-of-a-layer" class="router-link-active router-link-exact-active" data-v-4f8affad>Id of a Layer</a></li><!--]--></ul></li><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#adding-phases" class="router-link-active router-link-exact-active" data-v-4f8affad>Adding Phases</a><ul data-v-4f8affad><!--[--><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#initializing-a-phase" class="router-link-active router-link-exact-active" data-v-4f8affad>Initializing a Phase</a></li><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#readiness-via-dependencies" class="router-link-active router-link-exact-active" data-v-4f8affad>Readiness via Dependencies</a></li><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#order-of-a-phase" class="router-link-active router-link-exact-active" data-v-4f8affad>Order of a Phase</a></li><!--]--></ul></li><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#providing-configuration" class="router-link-active router-link-exact-active" data-v-4f8affad>Providing Configuration</a><ul data-v-4f8affad><!--[--><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#using-non-generic-layerbase" class="router-link-active router-link-exact-active" data-v-4f8affad>Using non-generic LayerBase</a></li><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#before-and-after-a-phase" class="router-link-active router-link-exact-active" data-v-4f8affad>Before and After a Phase</a></li><li data-v-4f8affad><a aria-current="page" href="/architecture/layer#providing-multiple-targets" class="router-link-active router-link-exact-active" data-v-4f8affad>Providing Multiple Targets</a></li><!--]--></ul></li><!--]--><li data-v-4f8affad><a class="return-to-top" href="#" data-v-4f8affad>Return to top</a></li></ul></nav></div><!--]--><!--]--></article></div><div class="bottom" data-v-9f599d13 data-v-1bbc78ba><footer data-v-1bbc78ba><div class="logo" data-v-1bbc78ba><a href="/" class="" data-v-1bbc78ba><img class="do logo mono" data-v-1bbc78ba></a><span data-v-1bbc78ba>Copyright (c) 2023 Mouseless - MIT License</span></div><nav data-v-1bbc78ba><!--[--><a href="/blueprints" class="" data-v-1bbc78ba>Blueprints</a><a href="/features" class="" data-v-1bbc78ba>Features</a><a href="/layers" class="" data-v-1bbc78ba>Layers</a><a href="/architecture" class="active" data-v-1bbc78ba>Architecture</a><a href="/release-notes" class="" data-v-1bbc78ba>Release Notes</a><!--]--><a href="https://github.com/mouseless/do" rel="noopener noreferrer" target="_blank" data-v-1bbc78ba><i class="fa-brands fa-github" data-v-1bbc78ba></i> /mouseless/do</a></nav></footer></div></div></div><script type="application/json" id="__NUXT_DATA__" data-ssr="true" data-src="/architecture/layer/_payload.json">[{"state":1,"_errors":3,"serverRendered":6,"pinia":7,"prerenderedAt":43},["Reactive",2],{},["Reactive",4],{"content-query-hBLt6OxXWy":5},null,true,["Reactive",8],{"sectionStore":9,"pageStore":27},{"sections":10},[11,15,18,21,24],{"_path":12,"_dir":13,"title":14},"/blueprints","","Blueprints",{"_path":16,"_dir":13,"title":17},"/features","Features",{"_path":19,"_dir":13,"title":20},"/layers","Layers",{"_path":22,"_dir":13,"title":23},"/architecture","Architecture",{"_path":25,"_dir":13,"title":26},"/release-notes","Release Notes",{"pages":28},[29,34,37,40],{"_path":22,"title":23,"pages":30},[31,32,33],"application","layer","feature",{"_path":35,"title":36},"/architecture/application","Application",{"_path":38,"title":39},"/architecture/layer","Layer",{"_path":41,"title":42},"/architecture/feature","Feature",1697014213054]</script><script>window.__NUXT__={};window.__NUXT__.config={public:{content:{locales:[],defaultLocale:"",integrity:1697014195232,experimental:{stripQueryParameters:false,clientDB:false,advancedIgnoresPattern:false},api:{baseURL:"/api/_content"},navigation:{fields:[]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"prose-code",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:"slack-dark",preload:["diff","ts","js","css","java","markdown","sql","xml","json","csharp","md","bash"]},wsUrl:"",documentDriven:false,host:"",trailingSlash:false,anchorLinks:{depth:0,exclude:[1]}},baseURL:"",githubURL:"/mouseless/do"},app:{baseURL:"/",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script><script type="module" src="/_nuxt/entry.50f5f578.js" crossorigin></script></body>
</html>